// Mochi Wikis app
// Copyright Alistair Cunningham 2025

{
	"version": "1.13",
	"label": "app_name",
	"classes": ["wiki"],
	"paths": ["wikis"],
	"services": ["wikis"],

	"architecture": {"engine": "starlark", "version": 2},
	"execute": ["wikis.star"],

	"database": {
		"schema": 8,
		"file": "wikis.db",
		"create": {"function": "database_create"},
		"upgrade": {"function": "database_upgrade"}
	},

	"icons": [
		{"action": "", "label": "app_name", "file": "images/icon.svg"}
	],

	"actions": {
		"": {"file": "web/dist/index.html", "public": true},
		"info": {"function": "action_info_class"},
		"create": {"function": "action_create"},
		"new": {"file": "web/dist/index.html", "public": true},
		"join": {"file": "web/dist/index.html", "public": true},
		"subscribe": {"function": "action_join"},
		"bookmark/add": {"function": "action_bookmark_add"},
		"bookmark/remove": {"function": "action_bookmark_remove"},
		"assets": {"files": "web/dist/assets", "public": true},
		"images": {"files": "web/dist/images", "public": true},
		":wiki": {"file": "web/dist/index.html", "public": true},
		":wiki/new": {"file": "web/dist/index.html"},
		":wiki/-/info": {"function": "action_info_entity", "public": true},
		":wiki/-/new": {"file": "web/dist/index.html"},
		":wiki/-/page/create": {"function": "action_new"},
		":wiki/-/search": {"function": "action_search", "public": true},
		":wiki/-/settings": {"function": "action_settings"},
		":wiki/-/settings/set": {"function": "action_settings_set"},
		":wiki/-/subscribers": {"function": "action_subscribers"},
		":wiki/-/subscriber/remove": {"function": "action_subscriber_remove"},
		":wiki/-/access": {"function": "action_access_list"},
		":wiki/-/access/set": {"function": "action_access_set"},
		":wiki/-/access/revoke": {"function": "action_access_revoke"},
		":wiki/-/delete": {"function": "action_delete"},
		":wiki/-/tags": {"function": "action_tags", "public": true},
		":wiki/-/tag/:tag": {"function": "action_tag_pages", "public": true},
		":wiki/-/changes": {"function": "action_changes", "public": true},
		":wiki/-/redirect/set": {"function": "action_redirect_set"},
		":wiki/-/redirect/delete": {"function": "action_redirect_delete"},
		":wiki/-/redirects": {"function": "action_redirects", "public": true},
		":wiki/-/sync": {"function": "action_sync"},
		":wiki/-/subscribe": {"function": "action_subscribe"},
		":wiki/-/unsubscribe": {"function": "action_unsubscribe"},
		":wiki/-/attachment/list": {"function": "action_attachments", "public": true},
		":wiki/-/attachment/upload": {"function": "action_attachment_upload"},
		":wiki/-/attachment/delete": {"function": "action_attachment_delete"},
		":wiki/-/attachments/:id": {"feature": "attachment", "public": true},
		":wiki/-/attachments/:id/thumbnail": {"feature": "attachment/thumbnail", "public": true},
		":wiki/assets": {"files": "web/dist/assets", "public": true},
		":wiki/images": {"files": "web/dist/images", "public": true},
		":wiki/:page/assets": {"files": "web/dist/assets", "public": true},
		":wiki/:page/images": {"files": "web/dist/images", "public": true},
		":wiki/-/:page": {"function": "action_page", "public": true},
		":wiki/-/:page/edit": {"function": "action_page_edit"},
		":wiki/-/:page/history": {"function": "action_page_history", "public": true},
		":wiki/-/:page/history/:version": {"function": "action_page_revision", "public": true},
		":wiki/-/:page/revert": {"function": "action_page_revert"},
		":wiki/-/:page/delete": {"function": "action_page_delete"},
		":wiki/-/:page/rename": {"function": "action_page_rename"},
		":wiki/-/:page/tag/add": {"function": "action_tag_add"},
		":wiki/-/:page/tag/remove": {"function": "action_tag_remove"},
		":wiki/:page": {"file": "web/dist/index.html", "public": true},
		"-/users/search": {"function": "action_users_search"},
		"-/groups": {"function": "action_groups"}
	},

	"events": {
		"subscribe": {"function": "event_subscribe"},
		"unsubscribe": {"function": "event_unsubscribe"},
		"sync": {"function": "event_sync"},
		"page/create": {"function": "event_page_create"},
		"page/update": {"function": "event_page_update"},
		"page/delete": {"function": "event_page_delete"},
		"page/edit/request": {"function": "event_page_edit_request"},
		"page/delete/request": {"function": "event_page_delete_request"},
		"attachment/upload/request": {"function": "event_attachment_upload_request"},
		"attachment/create": {"function": "event_attachment_create"},
		"attachment/delete": {"function": "event_attachment_delete"},
		"attachment/fetch": {"function": "event_attachment_fetch"},
		"redirect/set": {"function": "event_redirect_set"},
		"redirect/delete": {"function": "event_redirect_delete"},
		"tag/add": {"function": "event_tag_add"},
		"tag/remove": {"function": "event_tag_remove"},
		"setting/set": {"function": "event_setting_set"}
	}
}
