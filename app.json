// Mochi Wiki app
// Copyright Alistair Cunningham 2025

{
	"version": "1.0",
	"label": "app_name",
	"classes": ["wiki"],
	"paths": ["wiki"],

	"architecture": {"engine": "starlark", "version": 2},
	"execute": ["wiki.star"],

	"database": {
		"schema": 1,
		"file": "wiki.db",
		"create": {"function": "database_create"},
		"helpers": ["access", "attachments"]
	},

	"icons": [
		{"action": "", "label": "app_name", "file": "images/icon.svg"}
	],

	"actions": {
		"": {"file": "web/dist/index.html", "public": true},
		"info": {"function": "action_info_class", "public": true},
		"create": {"function": "action_create"},
		"new": {"function": "action_create"},
		"assets": {"files": "web/dist/assets", "public": true},
		"images": {"files": "web/dist/images", "public": true},
		":wiki": {"file": "web/dist/index.html", "public": true},
		":wiki/-/info": {"function": "action_info_entity", "public": true},
		":wiki/-/new": {"function": "action_new"},
		":wiki/-/search": {"function": "action_search", "public": true},
		":wiki/-/settings": {"function": "action_settings"},
		":wiki/-/settings/set": {"function": "action_settings_set"},
		":wiki/-/delete": {"function": "action_delete"},
		":wiki/-/tags": {"function": "action_tags", "public": true},
		":wiki/-/tag/:tag": {"function": "action_tag_pages", "public": true},
		":wiki/-/redirect/set": {"function": "action_redirect_set"},
		":wiki/-/redirect/delete": {"function": "action_redirect_delete"},
		":wiki/-/redirects": {"function": "action_redirects", "public": true},
		":wiki/-/sync": {"function": "action_sync"},
		":wiki/-/subscribe": {"function": "action_subscribe"},
		":wiki/-/attachment/list": {"function": "action_attachments", "public": true},
		":wiki/-/attachment/upload": {"function": "action_attachment_upload"},
		":wiki/-/attachment/delete": {"function": "action_attachment_delete"},
		":wiki/-/attachments": {"attachments": true, "public": true},
		":wiki/assets": {"files": "web/dist/assets", "public": true},
		":wiki/images": {"files": "web/dist/images", "public": true},
		":wiki/-/:page": {"function": "action_page", "public": true},
		":wiki/-/:page/edit": {"function": "action_page_edit"},
		":wiki/-/:page/history": {"function": "action_page_history", "public": true},
		":wiki/-/:page/history/:version": {"function": "action_page_revision", "public": true},
		":wiki/-/:page/revert": {"function": "action_page_revert"},
		":wiki/-/:page/delete": {"function": "action_page_delete"},
		":wiki/-/:page/tag/add": {"function": "action_tag_add"},
		":wiki/-/:page/tag/remove": {"function": "action_tag_remove"},
		":wiki/:page": {"file": "web/dist/index.html", "public": true}
	},

	"events": {
		"subscribe": {"function": "event_subscribe"},
		"sync": {"function": "event_sync"},
		"page/create": {"function": "event_page_create"},
		"page/update": {"function": "event_page_update"},
		"page/delete": {"function": "event_page_delete"},
		"redirect/set": {"function": "event_redirect_set"},
		"redirect/delete": {"function": "event_redirect_delete"},
		"tag/add": {"function": "event_tag_add"},
		"tag/remove": {"function": "event_tag_remove"},
		"setting/set": {"function": "event_setting_set"}
	}
}
